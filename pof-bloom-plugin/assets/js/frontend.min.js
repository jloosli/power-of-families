function bloomNav(a){"use strict";event.preventDefault(),a||(a=this);var b=a.getAttribute("href");return window.location.search=""===b?"":"page="+b,!1}!function(){function a(a){"use strict";a.style.height="1000px",jQuery(a).trigger("update"),a.style.height="auto",jQuery(a).trigger("update")}function b(a){"use strict";a.style.height="",jQuery(a).trigger("update")}function c(a){a.removeClass("doNotPrint"),a.siblings().addClass("doNotPrint"),a.parent().length&&c(a.parent())}function d(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}jQuery(document).ready(function(e){function f(){for(var a in window.theCharts){var b=[["Assessments","Average"]];window.theCharts[a].data.forEach(function(a){"use strict";b.push([a.assessment.split(" ")[0],a.average])});var c=google.visualization.arrayToDataTable(b),d=new google.visualization.DataView(c);d.setColumns([0,1,{calc:"stringify",sourceColumn:1,type:"number",role:"annotation"}]);var e={title:window.theCharts[a].category,hAxis:{title:"Assessments"},vAxis:{minValue:0,maxValue:5},legend:"none"},f=document.getElementsByClassName(window.theCharts[a].location);[].forEach.call(f,function(a){"use strict";var b=new google.visualization.ColumnChart(a);b.draw(c,e)})}}var g=e("#bloom"),h=g.find(".instructions");h.wrapInner("<div class='ins_content'></div>").prepend("<div class='ins_title'><h3>Instructions</h3> <small>(Click to expand)</small><small style='display:none;'>(Click to collapse)</small></div>").click(function(){"use strict";e("div.ins_content",this).toggle(),e("div.ins_title small",this).toggle()}),e("#pref_submit").click(function(a){"use strict";a.preventDefault();var b=e("#preferences").find(":radio:checked").val();b&&e.post(POM_BLOOM.ajax_url,{user:POM_BLOOM.current_user,preference:b,route:"preferences",action:"pom_bloom"},function(a){a&&a.success&&(window.location.search="page=overview")},"json")}),e("#pref_cancel").click(function(a){"use strict";a.preventDefault(),window.location.search="page=overview"}),e("form.assessment_create").submit(function(a){"use strict";a.preventDefault();var b=e(this).serializeArray(),c=jQuery("input:radio",g),d=[],f=[];c.each(function(a,c){-1===d.indexOf(c.name)&&(d.push(c.name),_.find(b,function(a){return a.name===c.name})||f.push(c.name))}),e(".qgroup").each(function(a,b){-1===f.indexOf(b.id.replace("_group",""))?e(b).removeClass("missing"):e(b).addClass("missing")}),f.length>0?e("#missing_warning").text("It looks like you're missing "+f.length+" answers. Please check your answers try submitting again.").show():(e("#missing_warning").hide(),e.post(POM_BLOOM.ajax_url,{user:POM_BLOOM.current_user,assessment:b,route:"assessments",action:"pom_bloom"},function(a){a&&a.success&&(window.location.search="page=overview")},"json"))}),window.fillform=function(a){jQuery('input[type="radio"]').each(function(b,c){0>a?c.checked=!1:parseInt(c.value)===parseInt(a)&&(c.checked=!0)})},e("form.goals_set",g).find(".subcategories select").change(function(){"use strict";var a,b=e(this),c=b.parents("fieldset").find(".recommendations .results"),d=e("<ul />"),f=e("option:selected",b).val();e("html, body").animate({scrollTop:c.offset().top-200},2e3),c.text("Looking up recommendations..."),e.post(POM_BLOOM.ajax_url,{user:POM_BLOOM.current_user,category_id:f,route:"goal_suggestions",action:"pom_bloom"},function(b){if(b&&b.success){if(!b.goals.length)return void c.text("No suggestions available for this category.");e.each(b.goals,function(b,c){a=e("<li />").append(e("<div></div>",{"class":"clickable","data-id":c.id,"data-per_week":c.per_week,text:c.suggestion,click:function(){var a=e(this),b=a.parents("fieldset"),c=b.find(".goal textarea"),d=b.find(".per_week select"),f=b.find('.goal input[name^="suggestions"]');a.addClass("selected").delay(2e3).queue(function(b){a.removeClass("selected"),b()}),c.val(a.text()),f.val(a.data("id")),d.val(a.data("per_week")),e("html, body").animate({scrollTop:c.offset().top-200},2e3)}})),a.appendTo(d)}),c.html(d)}},"json")}),e("form.goals_set",g).submit(function(a){a.preventDefault(),console.log(e(this).serialize()),e.post(POM_BLOOM.ajax_url,{user:POM_BLOOM.current_user,data:e(this).serialize(),route:"add_goals",action:"pom_bloom"},function(a){a&&a.success&&(window.location.search="page=overview")},"json")}),window.location.search.indexOf("page=goals.set")&&window.google&&(google=window.google,google.load("visualization","1.0",{callback:function(){},packages:["corechart"]}),google.setOnLoadCallback(f),window.onresize=d(f,200)),e("#goals_update .clickable",g).click(function(){"use strict";var a=e(this),b=a.hasClass("set"),c=a.siblings(".done"),d=c.data("per_week"),f=0;a.addClass("checking"),e.post(POM_BLOOM.ajax_url,{user:POM_BLOOM.current_user,set:!b,goal:a.data("goal"),day:a.data("day"),route:"update_goals",action:"pom_bloom"},function(b){b&&b.success&&(a.removeClass("set checking"),c.removeClass("set"),f=a.siblings(".set").length,b.set&&(a.addClass("set"),f+=1),f>=d&&c.addClass("set"))},"json")});var i=e("#goals_update .serendipity",g);i.on("change keyup paste",d(function(){"use strict";var a=e(this),b=a.parent().siblings(".done");b.removeClass("set"),""!==e.trim(a.val())&&b.addClass("set"),e.post(POM_BLOOM.ajax_url,{user:POM_BLOOM.current_user,serendipity:a.val(),id:a.data("id"),route:"update_serendipity",action:"pom_bloom"},function(){},"json")},200)),e("#goals_update").find("tr.goal th div").click(function(){"use strict";var c=e(this),d=c.triggerHandler("isTruncated");d?a(this):b(this)}).dotdotdot({callback:function(a,b){"use strict";a&&(this.title=b[0].data)}}).trigger("update.dot"),-1!==window.location.search.indexOf("goals.update")&&(e("body").children().addClass("doNotPrint"),c(e("#bloom"))),"moms.loc"===window.location.hostname&&e("img").each(function(a,b){b.src=b.src.replace("wp.com/moms.loc","wp.com/powerofmoms.com")})})}();